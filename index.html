<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"> <!--name space-->

<head>
	<meta http-equiv="Content-Type" content="text/html"; charset="UTF-8" />  <!--tell broweser prepare to rececive a html document -->
	<style type="text/css">
	*{
		margin:0;
		padding:0;
		border:0;
	}
	</style>


</head>
<body>
	<canvas id="myCanvas"></canvas>
	<script type="text/javascript">
			/************* object ***********************************/
		    // common event 
			var EventUtil={

				addHandler:function(element,type,handler){
						if(element.addEventListener)
						{
							element.addEventListener(type,handler,false); // fase: 在冒泡阶段捕获
						}
						else if(element.attachEvent)
						{
							element.attachEvent("on"+type,handler);
						}
						else
						{
							element["on"+type]=handler;
						}
				},

				removeHandler:function(element,type,handler)
				{
						if(element.removeEventListener)
						{
							element.removeEventListener(type,handler,false); // fase: 在冒泡阶段捕获
						}
						else if(element.detachEvent)
						{
							element.detachEvent("on"+type,handler);
						}
						else
						{
							element["on"+type]=null;
						};
				},

				getEvent:function(event){
					return event || window.event;
				},

				getTarget:function(event){
						return event.target || event.srcElement;
				},

				preventDefault:function(event)
				{
						if(event.preventDefault)
						{
							event.preventDefault();
						}
						else
						{
							event.returnValue = false;
						}
				},

				stopProgration:function(event)
				{
						if(event.stopProgration)
						{
							event.stopProgration();
						}
						else
						{
							event.cancelBubble = true;
						}
				},


			};	

	        /*************funtion declaration******************/
		    //The Fibonacci sequence .use a function with a name
		    var fblq=(function f(n){
		    	if(n==0)
		    	{
		    		return 0;
		    	}
		    	else if (n==1)
		    	{
		    		return 1;
		    	}
		    	else
		    	{
		    		return(f(n-1)+f(n-2));
		    	}

		    });

        /*************draw*************************************/
		var c=document.getElementById("myCanvas");
		EventUtil.addHandler(c,"load",drawSky());
		EventUtil.addHandler(window,"resize",drawSky());
		

		var step=0;
		function drawSky(){


			c.width=document.documentElement.clientWidth;
			c.height=document.documentElement.clientHeight;
			console.log('width:',c.width);
			console.log('height:',c.height);
			if(c.getContext)
			{
				var bgd=c.getContext("2d");
				bgd.width=c.width;
				bgd.height=c.height;

				/*background color*/
				//var gradient1=bgd.createLinearGradient(bgd.width,bgd.height,bgd.width,0);
				//gradient1.addColorStop(0,"#101880");
				//gradient1.addColorStop(1,"#000805");
				var gradient1=bgd.createRadialGradient(bgd.width,0,0,bgd.width,0,bgd.width);
				gradient1.addColorStop(0,"#000030");
				gradient1.addColorStop(1,"#000000");
				bgd.fillStyle=gradient1;
				bgd.fillRect(0,0,bgd.width,bgd.height);






			    /*star*/
			    var x1=2,x2=10,y1=1,y2=10,y3=16;
			    var interval=new Array(20);

			    interval[0]=fblq(5);
			    interval[1]=fblq(6);
			    console.log(interval[0]);
			    console.log(interval[1]);

				var loop=0;
				var angle=0.01;
			    while(loop<25)
				{
					var a=bgd.width-Math.floor(bgd.width*1/100);
					var b=Math.floor(bgd.height*1/100);
					loop+=1;
						


			    	for(var i=0,j=0;(a-i>0) && (b<bgd.height); i+=1,j+=0.2)
			   	 	{
			    	
				    	if(i>1)
				    	{
				    		interval[i]=interval[i-1]+interval[i-2];
				    	}
				    		
				    	a= a-Math.floor(Math.cos(angle*Math.PI)*interval[i]);
				    	b=b+Math.floor(Math.sin(angle*Math.PI)*interval[i]);
				 		bgd.beginPath();
				    	bgd.moveTo(a,b-y2);
				    	bgd.lineTo(a-x1-j,b-y1-j);
				    	bgd.lineTo(a-x2-j,b);		
		    			bgd.lineTo(a-x1-j,b+y1+j);	
		    			bgd.lineTo(a,b+y3+j);
		    			bgd.lineTo(a+x1+j,b+y1+j);
		    			bgd.lineTo(a+x2+j,b);
		    			bgd.lineTo(a+x1+j,b-y1-j);
		    			bgd.lineTo(a,b-y2-j);
		    			bgd.closePath();

				    	bgd.fillStyle="#FFFFBB";
				    	bgd.fill();
					}

					angle+=0.02;
				}

				/*moon*/
				bgd.beginPath();
			    var pointx=Math.floor(bgd.width*4/5);
			    var pointy=Math.floor(bgd.height*1/3);
			    var radius=Math.floor(bgd.height*1/7);
			    bgd.arc(pointx,pointy,radius,0.1*Math.PI,1.33*Math.PI,false);
			    bgd.moveTo(pointx-Math.floor(radius*Math.cos(0.33*Math.PI)),pointy-Math.floor(radius*Math.sin(0.33*Math.PI)));
			    bgd.quadraticCurveTo(pointx-Math.floor((radius*Math.cos(0.3*Math.PI))*4/5),pointy+Math.floor((radius*Math.sin(0.3*Math.PI))*4/5),pointx+Math.floor(radius*Math.cos(0.1*Math.PI)),pointy+Math.floor(radius*Math.sin(0.1*Math.PI)));
			    bgd.closePath();
			    bgd.fillStyle="#FFFF00";
			    bgd.fill();


				/* moving house*/

				var offset=0;	

				function run()
				{
					var housebodywidth=Math.floor(bgd.width*1/15),housebodyheight=Math.floor(bgd.height*1/9);
					//var h1=Math.floor(bgd.width*1/9);
					var h1=Math.floor(step % bgd.width);
					var v1=Math.floor(bgd.height*7/9);


					//housebody
					bgd.beginPath();
					bgd.moveTo(h1,v1);
					bgd.fillStyle="#A9A9AA";
					bgd.fillRect(h1,v1,housebodywidth,housebodyheight);
					bgd.setLineDash([0,0,0]);
	  				bgd.lineWidth=1;
					bgd.strokeStyle="#FFFF89";
					bgd.strokeRect(h1,v1,housebodywidth,housebodyheight);
					bgd.closePath();
					

					//roof
					bgd.beginPath();
					bgd.moveTo(h1,v1);
					bgd.lineTo(h1+Math.floor(housebodywidth/2),v1-Math.floor(housebodyheight/2));
					bgd.lineTo(h1+housebodywidth,v1);
					bgd.lineTo(h1,v1);
					bgd.fillStyle="#800080";
					bgd.fill();
					bgd.setLineDash([0,0,0]);
					bgd.lineWidth=1;
					bgd.strokeStyle="#FFFF89";
					bgd.stroke();
					bgd.closePath();

					//window
					bgd.beginPath();
					bgd.moveTo(h1+Math.floor(housebodywidth/8),v1-Math.floor(housebodyheight/8));
					bgd.fillStyle="#FFFF89";
					bgd.fillRect(h1+Math.floor(housebodywidth/8),v1+Math.floor(housebodyheight/8),Math.floor(housebodywidth/4),Math.floor(housebodyheight/3));
					bgd.closePath();

					//door
					bgd.beginPath();
					bgd.moveTo(h1+Math.floor(housebodywidth/8),v1-Math.floor(housebodyheight/8));
					bgd.fillStyle="#FFFF89";
					bgd.fillRect(h1+Math.floor(housebodywidth*2/3),v1+Math.floor(housebodyheight*4/7),Math.floor(housebodywidth/6),Math.floor(housebodyheight*3/7));
					bgd.closePath();
					
					//wheel

					bgd.beginPath();
					bgd.setLineDash([3,3,3]);
	  				bgd.lineDashOffset =-offset;
	  				bgd.lineWidth=Math.floor(housebodywidth/10);
					//bgd.moveTo(h1+Math.floor(housebodywidth),v1+Math.floor(housebodyheight));
					bgd.arc(h1+Math.floor(housebodywidth),v1+Math.floor(housebodyheight*5/4),Math.floor(housebodyheight/4),0,2*Math.PI);
					bgd.fillStyle="#800080";
					bgd.fill();
					bgd.strokeStyle="#FFFF89";
					bgd.stroke();
					bgd.closePath();

					bgd.beginPath();
					bgd.arc(h1,v1+Math.floor(housebodyheight*5/4),Math.floor(housebodyheight/4),0,2*Math.PI);
					bgd.fillStyle="#800080";
					bgd.fill();
					bgd.strokeStyle="#FFFF89";
					bgd.stroke();
					bgd.closePath();

				}

				function wheelrun(){
					offset++;
					if(offset>30)
					{
						offset=0;
						step+=5;
						clearTimeout(t);
						t=null;
						drawSky();
					}

					run();

					t=setTimeout(wheelrun,20);


				}
				wheelrun();

			}
	}
	</script>
	
</body>
</html> 